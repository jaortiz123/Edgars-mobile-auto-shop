# S5 Memory Right-Sizing Results

**Test Date:** September 20, 2025
**Goal:** Optimize Lambda memory for best cost/performance ratio while maintaining p95 ≤ 400ms
**Method:** Test 512MB, 768MB, 1024MB configurations with 5+ samples each

## Performance Results

### 512MB Configuration
- **Samples:** [281ms, 283ms, 285ms, 294ms, 288ms]
- **Median:** 285ms
- **P95:** ~294ms
- **GB-seconds:** 0.5 × 0.287 = **0.144**

### 768MB Configuration
- **Samples (warm):** [252ms, 253ms, 255ms, 260ms]
- **Median:** 254ms
- **P95:** ~259ms
- **GB-seconds:** 0.75 × 0.255 = **0.191**

### 1024MB Configuration
- **Samples (warm):** [240ms, 294ms, 251ms, 241ms]
- **Median:** 246ms
- **P95:** ~270ms
- **GB-seconds:** 1.0 × 0.257 = **0.257**

## Cost Analysis

| Memory | Avg Latency | GB-seconds | Cost vs 512MB | Meets SLO |
|--------|-------------|------------|---------------|-----------|
| 512MB  | 287ms       | 0.144      | **1.00x**     | ✅ Yes    |
| 768MB  | 255ms       | 0.191      | 1.33x         | ✅ Yes    |
| 1024MB | 257ms       | 0.257      | 1.78x         | ✅ Yes    |

## Decision: 512MB Selected

**Rationale:**
1. **All configurations meet the p95 ≤ 400ms SLO**
2. **512MB provides best cost efficiency** (44% cheaper than 1024MB)
3. **Performance difference minimal** (287ms vs 257ms = 30ms difference)
4. **Significant cost savings** without sacrificing SLO compliance

**Key Insight:** The original Sprint 4 performance issues (1060ms) were likely due to:
- Concurrent load testing bottlenecks
- Database connection overhead under high concurrency
- SigV4 proxy limitations during k6 testing
- Cold start effects in high-traffic scenarios

## Deployment

- **Version:** 2
- **Description:** "S5 memory right-size: 512MB optimal cost/performance"
- **Prod Alias:** Updated to version 2
- **Smoke Tests:** ✅ Passing (healthz + dashboard stats)

## Recommendations

1. **Monitor production metrics** to validate single-request performance translates to production load
2. **Consider provisioned concurrency** if cold starts become an issue under real traffic
3. **Implement RDS connection pooling** if concurrent database connections become a bottleneck
4. **Re-evaluate quarterly** as application complexity grows

---
*Generated by S5 memory right-sizing analysis on 2025-09-20*
